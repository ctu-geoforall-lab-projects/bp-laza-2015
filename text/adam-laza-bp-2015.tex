\documentclass[12pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[czech, english]{babel}
\usepackage[T1]{fontenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage[final,pdftex, colorlinks=false]{hyperref}
\usepackage{xcolor}
\usepackage{comment}
\usepackage{todonotes}
\usepackage{floatrow}
\usepackage{multirow}

\usepackage{listings}			%vkladani kodu
\lstset{basicstyle=\ttfamily,
  showstringspaces=false,
  commentstyle=\color{red},
  keywordstyle=\color{blue},
  breaklines=true,
  frame=lines,
}

%okraje
\usepackage[
left=35mm,
right=25mm,
top=40mm,
bottom=35mm]
{geometry}

\author{Adam Laža}

%%%%%%%%%%Prikazy%%%%%%%%%%
\renewcommand\baselinestretch{1.3}		%radkovani
\parskip=0.8ex plus 0.4ex minus 0.1 ex	%mezera mezi odstavci

\newcommand{\keywords}[2]{\noindent\textbf{#1: }#2}

\newcommand{\necislovana}[1]{%
\phantomsection
\addcontentsline{toc}{section}{#1}

%\newcommand{\exedout}{%
%  \rule{0.8\textwidth}{0.5\textwidth}%
%}


\section*{#1}
\markboth{\uppercase{#1}}{}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%Zahlavi%%%%%%%%%%%
\usepackage{fancyhdr}
\fancyhead[L]{ČVUT v~Praze}
\setlength{\headheight}{16pt}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}
\pagestyle{empty}

\newpage
\input{titulbp}

\newpage
\begin{abstract}
\bigskip
Cílem této bakalářské práce je návrh a implementace nástroje pro interpolaci metodou přirozeného souseda pro GRASS GIS 7. Starší verze GRASS GIS 6 sice tuto metodu nabízí v rámci volitelně doinstalovatelných balíčků Add-Ons, ale jako modul napsaný v Bashi a s vnitřní závislostí na knihovně \emph{nn-c}. Tato knihovna obsahuje knihovnu \emph{Triangle}, která nedovoluje zařazení tohoto nástroje do oficiální distribuce GRASS GISu.

V rámci této bakalářské práce byl modul přepsán do jazyka Python, tak aby vyhovoval verzi 7. Práce se dále zabývá možnostmi budoucí implementace knihovny v jazyce C bez závislosti na knihovně \emph{Triangle}, tak aby mohl tento interpolační nástroj zařazen do oficiální distribude GRASS GISu.
Část textu této práce se dále zabývá porovnání rychlosti a kvality výstupu mezi GRASS GISem a ostatními gisovými softwary.

\bigskip
\keywords{Klíčová slova}{GIS, GRASS GIS, interpolace, přirozený soused, Delaunayho triangulace, Voronoiovy polygony}

\end{abstract}

\selectlanguage{english}
\begin{abstract}
\bigskip
The aim of this bachelor thesis is the project and the implementation of a tool for a natural neighbour interpolation pro GRASS GIS 7. Previous version GRASS GIS 6 contains such a tool as a optional package of Add-Ons, but this modul is written in Bash and with inner dependency on \emph{nn-c} library. Due to this library contains \emph{Triangle} library which is not under the GNU GPL licence it is not possible to add the interpolation tool into official GRASS GIS distribution.

\bigskip
\keywords{Keywords}{GIS, GRASS GIS, natural neighbour interpolation, Delaunay triangulation, Voronoi's polygons}

\end{abstract}
\selectlanguage{czech}

\newpage
\tableofcontents

\newpage
\pagestyle{fancy}

\necislovana{Úvod}
V reálném životě se většinou nesetkáváme s případem, kdy pro naši oblast zájmu, ať už se jedná o interval, plochu nebo prostor, máme dostatek bodových dat o daném jevu. Mnohem častěji máme k dispozici pouze soubor bodových dat, která jsou buď náhodně nebo uspořádaně rozmístěna po naší oblasti zájmu. Fyzické zhuštění takovéto sítě a sběr dalších dat může být časově či finančně náročné, příliš obtížné nebo v rámci možností metod zcela nereálné.

Obvykle ovšem potřebujeme znát hodnotu daného jevu i mimo měřené body, nejčastěji pro celé zájmové území. V takovéto chvíli se musíme použít nějaký interpolační nástroj, který vypočte přibližnou hodnotu v území mezi měřenými body. Jako příklad může být uvedeno vytvoření výškopisu, či DMT pro území, kde máme k dispozici data o výšce v pravidelné mřížce nebo teplotní mapa na základě údajů z nepravidelně rozmístěných meteostanic.

\bigskip
V této práci se budu zabývat interpolací přirozeného souseda a její implementací do GRASS GISu 7.\footnote{\url{http://grass.osgeo.org}} Toto téma Bakalářské práce jsem si vybral z několika důvodů. Za prvé, mě zajímají geografické informační systémy, zejména pak open-source projekty. Dle mého názoru je to právě cesta open-source softwarů, kterou se budou v~budoucnosti soukromé firmy, vývoj a věda ubírat, a je proto dobré s nimi získávat zkušenost už během studia. Za druhé, práce na tomto tématu mi umožnila proniknout do GISů nejen z pohledu uživatele, ale přiučit se alespoň elementární základy jako vývojář. A za třetí, interpolace metodou přirozeného souseda je nástroj, který poskytuje kvalitní výstupy, a jeho začlenění do standardní distribuce GRASS GISu by mohlo být hojně využito.

V současné době je interpolace metodou přirozeného souseda prováděna pomocí modulů \emph{v.surf.nnbathy} a \emph{r.surf.nnbathy} z rozšíření Add-Ons, které jsou navíc napsané v Bashi. Tyto moduly jsou však podporované pouze pro GRASS GIS do verze 6. Od 22. února 2015 ovšem byla uvolněná verze 7, která nepodporuje moduly psané v Bashi. Jako první krok, je tedy nutné moduly přepsat do podporovaného jazyka- Pythonu. Dalším krokem bude zbavení závislosti knihovny \emph{nn-c}, která provádí samotnou interpolaci, na knihovně \emph{Triangle}, která konstruuje Delaunayovu triangulaci, ale kterou kvůli nevyhovující licenci není možné použít do standardní distribuce GRASS GISu.

\newpage
\part{Teoretická část}

\newpage
\section{GRASS GIS}
GRASS (Geographic Resources Analysis Support System) GIS\footnote{http://grass.osgeo.org/} je geografický informační systém pro správu a analýzu prostorových dat, obrazových záznamů, produkci map a grafických výstupů, prostorové modelování a 3D vizualizaci. Na mnoha platformách (GNU/Linux, MS Windows, MAC OS) umožňuje práci s rastrovými i vektorovými daty a to buď pomocí příkazové řádky nebo grafického uživatelského rozhraní. GRASS GIS je otevřený a volně šiřitelný software pod licencí GNU GPL.

Historie\cite{rukovet} GRASS GISu začíná v roce 1982, kdy začal být vyvíjen U.S. Army Corps of Enginneer/CERL (Construction Engineering Research Lab) pro vojenské účely. Nicméně koncem osmdesátých let byly veškeré zdrojové kódy dány k dispozici veřejnosti. Na začátku devadesátých let se začal pomocí internetu celosvětově rozšiřovat. V roce 1995 CERL odstoupil od projektu a vývoje se ujal GRASS Development Team, který zahrnoval odborníky z celého světa.

GRASS je jeden z nejznámějších open-source GIS softwarů, jehož vývoj trvá déle než třicet let. Jádro softwaru je napsáno v jazyce C. Avšak snahou vývojářů je rozšíření GRASSu mezi širší odbornou veřejnost a proto v rámci snadnějšího použití jsou do programu začleněny moduly napsané v jazyce Python nebo C. Aktuálně je k dispozici verze 7, na jejímž vývoji se podílí několik vývojářů z řad dobrovolníků po celém světe.

\subsection{GRASS GIS Add-Ons}
GRASS GIS je od roku 1982 v neustálem vývoji. Síla a úspěch GRASS GISu je založená hlavně na komunitě uživatelů. S ohledem na to, je filozofií vývojového týmu GRASS GISu vést uživatele k tvorbě jejich vlastních nástrojů a aplikaci pro GRASS GIS. Pokud uživatel vyvine nějaký nástroj, který by mohl být užitečný ostatním uživatelům má možnost svůj kód zveřejnit a zpřístupnit ostatním uživatelům pomocí Add-Ons\footnote{http://grass.osgeo.org/download/addons/}.

\newpage
\section{Delaunayova triangulace}
Interpolace metodou přirozeného souseda vychází z Delanayovi triangulace(DT) či Voronoiova diagramu(VD). Jak DT či VD jsou důležité konstrukce ve výpočetní geometrii. Delaunayova triangulace lze odvodit z Voronoiova diagramu a stejně tak Voronoiův diagram se dá naopak odvodit z Dalunayovi triangulace.

\subsection{Triangulace obecně}
\textbf{Definice\cite{TB1}:}
Triangulace $\Delta$ nad množinou bodu $P$ představuje takové planární rozdělení, které vytvoří soubor $m$ trojúhelníků $t = \{ t_1, t_2,...,t_m \}$ a hran tak, aby platilo:

Libovolné dva trojúhelníky $t_i$,$t_j \in \Delta, (i \neq j)$, mají společnou nejvýše hranu.

Sjednocení všech trojúhelníků $t \in \Delta$ tvoří doménu $\Omega$.

Uvnitř žádného trojúhelníku neleží žádný další bod z P.

\bigskip
Triangulace má širokou škálu aklikací. V kartografii a GISech se využívá pro tvorbu DMT. V DPZ lze využít pro tvorbu prostorových modelů, své uplatnění najde také v počítačové grafice a vizualizaci prostorových dat a mnoho dalších.

V našem případě budeme triangulaci provádět uvnitř takzvaného \emph{konvexního obalu}. Konvexní obal množiny bodů $P$ představuje takový konvexní mnohoúhelník, který obsahuje všechny body množiny bodů P, má co nejmenší plochu a ve kterém zároveň spojnice mezi kterýmikoliv body množiny bodů $P$ leží uvnitř obalu.

\newpage
\begin{figure}[h!]
\centering
\begin{floatrow}
\ffigbox{\includegraphics[width=0.48\textwidth]{img/body.png}}{\caption{Soubor bodů}}{\label{fig:soubor_bodu}}
\ffigbox{\includegraphics[width=0.48\textwidth]{img/domain.png}}{\caption{Konvexní obal nad doménou $\Omega$ }}{\label{fig:domena}}
\end{floatrow}
\end{figure}

\newpage
\subsection{Validní a regulérní triangulace}
V podstatě by se dalo říct, že triangulace je jakákoliv trojúhelníkoví síť mezi body v prostoru. Tato práce se však bude zabývat triangulační sítí se specifickými vlastnostmi.

1. Žádný z trojúhelníků $t_{ijk}$ není zdegenerovaný, tzn. že vrcholy $i, j, k$ neleží na přímce.
\begin{figure}[h!]
\centering
\includegraphics[width=0.9\textwidth]{img/podm_1.png}
\caption{Degenerace trojúhelníku}
\label{fig:podm_1}
\end{figure}

2. Žádná dvojice trojúhelníků se nepřekrývá, tzn $Int(t_{ijk}) \cap Int(t_{lmn}) = \emptyset$.
\begin{figure}[h!]
\centering
\includegraphics[width=0.25\textwidth]{img/podm_2.png}
\caption{Překrývající se trojúhelníky}
\label{fig:podm_2}
\end{figure}

3. Hranice dvou trojúhelníků se setkávají pouze na jejich hranách nebo v jejich vrcholech.

4. Sjednocení všech trojúhelníků v celé triangulační síti se rovná celé doméně $\Omega$, nad kterou triangulaci provádíme.
\begin{figure}[h!]
\centering
\includegraphics[width=0.25\textwidth]{img/podm_domena.png}
\caption{Nespojitá doména, triangulace obsahující díry}
\label{fig:podm_domena}
\end{figure}

5. Doména $\Omega$ musí být spojitá.

6. Triangulační síť nesmí obsahovat díry.

7. Jestliže vrchol $v_i$ leží na hranici konvexního obalu, pak musí existovat právě dvě hraniční hrany, které mají vrchol $v_i$ jako společný vrchol. To mimo jiné znamená, že počet hraničních vrcholů je roven počtu hraničních hran.

\bigskip
Pokud jsou naplněny první čtyři podmínky, může se triangulace nazvat \emph{validní}. V případě, že naplníme všech sedm podmínek, dá se mluvit o \emph{regulérní} triangulaci.

\begin{figure}[h!]
\centering
\includegraphics[width=0.9\textwidth]{img/vnr.png}
\caption{Triangulace validní, ale neregulérní}
\label{fig:trian_valid_not_reg}
\end{figure}

V případě triangulace na Obrázku \ref{fig:trian_valid_not_reg} se jedná o triangulaci validní, neboť splňuje všechny z prvních čtyř podmínek. Nicméně nesplňuje podmínku č. 7, neboť existují více jak právě dvě hraniční hrany, které vstupují do jednoho vrcholu na konvexním obalu, a triangulaci tedy nelze nazvat i regulérní.

\begin{figure}[h!]
\centering
\includegraphics[width=0.9\textwidth]{img/nv.png}
\caption{Triangulace nevalidní}
\label{fig:train_not_valid}
\end{figure}

\newpage
Triangulace na Obrázku \ref{fig:train_not_valid} není validní, protože nesplňuje podmínku č. 3. Tím pádem se nejedná ani o triangulaci regulérní.

\begin{figure}[h!]
\centering
\includegraphics[width=0.9\textwidth]{img/triangulation.png}
\caption{Regulérní triangulace}
\label{fig:triangulace}
\end{figure}

Na Obrázku \ref{fig:triangulace} už můžeme vidět validní a regulérní triangulaci. Jedná se též o triangulaci \emph{optimální}, což je termín, kterým se budeme zabývat v další kapitole.

\newpage
\subsection{Optimální triangulace}

Nad doménou $\Omega$ neexistuje pouze jediná trojúhelníková síť, v závislosti na počtu bodů v množině a jejich konfiguraci existuje poměrně velké množství možností, jak může trojúhelníková síť vypadat. Ne všechny sítě jsou však vhodné k dalšímu zpracovávání, a právě proto je snaha najít \emph{optimální} triangulaci.

Při řešení otázky, jak vypadá optimální triangulace, je zásadní zamyslet se nad tvarem trojúhelníků. V ideálním případě by byly všechny trojúhelníky rovnostranné, leč tento případ se v případě náhodně roztroušených dat nevyskytuje.

Při tvorbě optimální triangulace se tedy problém řeší z opačného konce. Zásadní snahou při tvorbě sítě by mělo být vyhýbání se podlouhlým, štíhlým nebo téměř degenerovaným trojúhelníkům, tedy trojúhelníkům s příliš ostrými nebo s příliš tupými úhly. 

\paragraph{Kruhová podmínka}
Definice:
Nechť hrana $\overline{p_ip_j}$ inciduje s trojúhelníkem $t_1$ tvořeným vrcholy $p_i,p_j,p_k$ a trojúhelníkem $t_2$ tvořeným vrcholy $p_i,p_j,p_l$ a kružnice $k$ procházející body $p_i,p_j,p_k$. Hrana $\overline{p_ip_j}$ je nelegální tehdy a právě jen tehdy, jestliže bod $p_l$ leží uvnitř $k$.

Pokud tedy bod $p_l$ leží uvnitř kružnice $k$, je hrana $\overline{p_ip_j}$ a tedy diagonála čtyřúhelníku nelegální, stejně tak jako oba trojúhelníky $t_1$ a $t_2$. K jejich legalizaci je provést tzv. \emph{Edge swaping}.

\paragraph{MaxMin a MinMax úhlová podmínka}

Pokud nad množinou bodů P provedeme všechny možné triangulace, můžeme nejoptimálnější triangulaci určit pomocí MaxMin popř. MinMax podmínky. V případě MaxMin podmínky je pro každou možnou triangulaci nalezen největší minimální vnitřní úhel trojúhelníku a ten je porovnán s největším minimálním úhel ostatních triangulací, což vede k eliminaci trojúhelníků s velmi tupými úhly. U MinMax podmínky se postupuje obdobně, pouze se porovnávají nejmenší maximální vnitřní úhly trojúhelníků a eliminují se tak trojúhelníky s velmi ostrými úhly.

\newpage
MinMax podmínka:
Eliminace trojúhelníků s příliš tupými úhly. Triangulace $\Delta(P)$ je vzhledem k tomuto kritériu na rozdíl od triangulace $\Delta^{'}(P)$ optimální, je–li největší úhel $\alpha$ generovaný triangulací $\Delta(P)$ menší než největší úhel $\alpha^{'}$ generovaný triangulací $\Delta^{'}(P)$.

$\alpha_{max} = max(\alpha_i(\Delta))$

$\alpha^{'}_{max} = max(\alpha_i^{'}(\Delta))$

$\alpha_{max} < \alpha^{'}_{max}$

\bigskip
MaxMin podmínka:
Eliminace trojúhelníků s příliš ostrými úhly. Triangulace $\Delta(P)$ je vzhledem k tomuto kritériu na rozdíl od triangulace $\Delta^{'}(P)$ optimální, je–li nejmenší úhel $\alpha$ generovaný triangulací $\Delta(P)$ větší než nejmenší úhel $\alpha^{'}$ generovaný triangulací $\Delta^{'}(P)$.

$\alpha_{min} = min(\alpha_i(\Delta))$

$\alpha^{'}_{min} = min(\alpha_i^{'}(\Delta))$

$\alpha_{min} > \alpha^{'}_{min}$

\paragraph{Neutrální případ pro MaxMin podmínku}

Problém nastává ve chvíli, kdy některé body, mezi kterými chceme triangulaci provést, leží na kružnici nebo se tomu limitně blíží. v takových chvílí nastává takzvaný neutrální případ pro MaxMin podmínku. V některých případech to může vést k nejednoznačnému určení, která z triangulací je optimální a musíme si pomoci hodnocením na základě nejen MaxMin ale i MinMax podmínky.

\begin{figure}[h!]
\centering
\begin{floatrow}
\ffigbox{\includegraphics[width=0.48\textwidth]{img/minmax2_pokus.png}}{\caption{Případ1}\label{fig:neutral_case_1}}
\ffigbox{\includegraphics[width=0.48\textwidth]{img/minmax1_pokus.png}}{\caption{Případ2}\label{fig:neutral_case_2}}
\end{floatrow}
\end{figure}


Nejčastěji tento jev nastává u čtyřúhelníků, jejichž všechny vrcholy leží na kružnici. Jak můžeme vidět na Obrázcích \ref{fig:neutral_case_1} a \ref{fig:neutral_case_2}, maximální minimální úhel triangulace je v obou případech úhel $\alpha$, což je obvodový úhel nejkratší strany čtyřúhelníku. V tomto případě se tedy jedná o neutrální případ pro MaxMin podmínku. Pokud bychom tedy triangulaci vyhodnocovali pouze na základě MaxMin podmínky mohly bychom obě triangulace prohlásit za optimální. Už od pohledu je ale zřejmé, že lepší tvar trojúhelníků poskytujeme triangulace nalevo. Pokud ale triangulace hodnotíme i s ohledem na MinMax podmínknu, můžeme prokázat, že triangulace na Obrázku \ref{fig:neutral_case_2} je optimální.


\paragraph{Edge swaping, legalizace}
Na Obrázcích \ref{fig:neutral_case_1} a \ref{fig:neutral_case_2} jsme si ukázali případ neutrálního případu pro MinMax podmínku. Proces, při kterém jsme zaměnili diagonálu čtyřúhelníku tak, aby byli oba trojúhelníky lokálně optimální, se nazýva \emph{Edge swaping.} Pokud budeme tento proces aplikovat pro celou triangulaci dojde k takzvané \emph{legalizaci} triangulace.

\newpage
\subsection{Voronoiovy diagramy}

Voronoiovy diagramy úzce souvisí s Delaunayovou triangulací. Představme si opět množinu bodů $P = \{p_1,...p_N\} $ v rovině $E^2$ a nechť je $d(p_i,p_j) $ Eukleidovská vzdálenost mezi body $p_i$ a $p_j$. Rovinu po té rozdělíme na oblasti $V(p_i,...,p_N)$, kde každému bodu $p_i$ z množiny $P$ přiřadíme takovou oblast, která splňuje následující podmínku: 

$V(p_i) = \{ x: d(x, p_i) < d(x, p_j), j = 1,...,N\}$.

Pro každou takovouto oblast přiřazenou bodu $p_i$ po té platí, že všechny body uvnitř této oblasti jsou k bodu $p_i$ blíž než ke kterémukoliv jinému bodu z množiny $P$. Toto rozdělení roviny se nazývá \emph{Voronoiův diagram (VD)} množiny bodů a každá uzavřená buňka se nazývá \emph{Voronoiova buňka.}

\bigskip
Voronoiův diagram má následující vlastnosti: 
\begin{enumerate}
\item Voronoiův diagram pro množinu bodů je pouze jeden.
\item Všechny oblasti jsou konvexní.
\item Oblast $V(p_i)$ obsahuje jediný bod $p_i \in P$.
\item Oblasti na okraji jsou neohraničené.
\item Počet hran a uzlů je přímo úměrný počtu bodů v množině P.
\item Pokud žádné 4 body neleží na kružnici, uzly mají stupeň 3.
\item Uzel leží ve středu kružnice určené 3 body z P, které leží v přilehlých oblastech a neleží na přímce.
\end{enumerate}

Nechť $H(p_i,P_j)$ je polorovina obsahující všechny body v rovině, jejichž vzdálenost od bodu $p_i$ je menší než od bodu $p_j$. Potom Voronoiova oblast $V(p_i)$ je průnikem N-1 polorovin,
$V(p_i)= \bigcap\limits_{\substack{j=1,...,N \\ i\not=j}}H(p_i,p_j)$, kde každá oblast má maximálně N-1 stran.

\newpage
\begin{figure}[h!]
\centering
\includegraphics[width=0.9\textwidth]{img/vor_pol.png}
\caption{Voronoivy polygony}
\label{fig:vor_pol}
\end{figure}

Z Obrázku \ref{fig:vor_pol} je vidět, že oblasti přiřazené pro body na okraji konvexního obalu nejsou zcela ohraničené a uzavřené. Jednotlivé hranice oblastí nazýváme \emph{Voronoiovy polygony}, které jsou složeny z takzvaných \emph{Voronoiových hran a bodů}. O dvou bodech $p_j$ a $p_k$ můžeme tvrdit, že jsou \emph{Voronoiovi sousedé}, pokud oblasti, kterým náleží, sdílí společnou \emph{Voronoiovu hranu}. 

Občas se můžeme setkat i s označením \emph{Thiessenovy polygony} podle klimatologa Thiessena, který Voronoiovi diagramy používal k interpolaci klimatických dat z náhodně distribuovaných meteorologických stanic.

\newpage
\subsection{Voronoiovy diagramy a Delaunayova triangulace}

DT je planární graf, který je duální k VD. Jedna konstrukce tedy může být odvozena od druhé a naopak. 
Pokud pro množinu bodů v rovině provedeme rozdělení do Voronoiových diagramů a následně spojíme úsečkami všechny Voronoiovi sousedy získáme Delaunayovu triangulaci.

\begin{figure}[h!]
\centering
\begin{floatrow}
\ffigbox{\includegraphics[width=0.45\textwidth]{img/vd_vor.png}}{\caption{Voronoiův diagram souboru bodů}}{\label{fig:vd_vor}}
\ffigbox{\includegraphics[width=0.45\textwidth]{img/vd_del.png}}{\caption{Voronoiův diagram a Delaunayova trinagulace}}{\label{fig:vd_del}}
\end{floatrow}
\end{figure}

Na Obrázku \ref{fig:vd_vor} můžeme vidět Voronoiův diagram pro množinu bodů. Pokud každou dvojici Voronoiových sousedů spojíme spojnicí, jak je vidět na Obrázku \ref{fig:vd_del} získáme několik trojúhelníků, které se nepřekrývají a tvoří trojúhelníkovou síť. Spojnice mezi body, které jsou přiřazeny k neuzavřeným oblastím, tvoří konvexní obal. Pro trojúhelníkovou síť uvnitř tohoto konvexního obalu se jedná o Delaunayovu triangulaci.

Trojúhelníky této sítě se nazývají \emph{Delaunayovi trojúhelníky}, které jsou tvořeny spojnicemi tzv. \emph{Delaunayvými hranami}. Dále je také zřejmé, že Voronoiovy hrany leží na ose Delaunayových hran.


\newpage
\section{Algoritmy pro tvorbu DT}
Triangulační algoritmy jsou poměrně dobře matematicky prozkoumaná oblast, ke které máme k dispozici široký teoretický základ. Při hledání vhodného algoritmu musíme zohlednit následující požadavky:
\begin{itemize}
\item Jednoduchost algoritmu a jeho snadná implementace.
\item Dostatečná rychlost i pro velké množiny bodů (n>1E6), ideálně aby se výpočetní čas blížil $O(n . log(n))$.
\item Malá citlivost a vysoká stabilita pro případy nejednoznačné triangulace (body na kružnici).
\item Převod do vyšších dimenzí.
\item Možnost paralelizace algoritmu.
\end{itemize}
Vhodný algoritmus je třeba vybírat na základe datových struktur a konkrétním případu. Ne vždy lze dokonale splnit všechny požadavky, např. jednoduché implementace mají delší výpočetní čas. Naopak algoritmy s kratším výpočetním časem jsou dost náročné na implementaci.

\subsection{Lokální optimalizace}
\emph{Lokální optimalizace (LO)} je proces přetvoření libovolné triangulace DT. Proces je prováděn pomocí prohazování nelegálních hran v dvojicích trojúhelníků tvořících konvexní čtyřúhelník na základě Kruhové nebo MaxMin podmínky.

Pro množinu bodu $P$ nechť $e_i$ je vnitřní hrana triangulace a $Q$ je čtyřúhelník tvořený dvěma trojúhelníky se společnou hranou $e_i$. Pomineme možnost, že čtyřúhelník je nekonvexní nebo že všechny body leží na kružnici. Po té za použití MaxMin nebo Kruhové podmínky rozhodněme, zda je třeba prohodit hranu $e_i$. V případě, že po použití Lokální optimalizace není potřeba prohodit hranu, můžeme ji prohlásit za lokálně optimální. V případě, že  budeme lokální optimalizaci používat opakovaně pro všechny hrany v triangulaci, dokud nebudou všechny hrany lokálně optimální, získáme optimální triangulaci.

\todo[inline]{Jak psát pseudokód??}


\hrule
1. Vytvoř pomocnou triangulaci $\Delta(P)$.

2. legal=false

3. while $\Delta(P)$ !legal

4.\indent legal=true;

5.\indent Opakuj pro $\forall e_i \in \Delta(P)$

6.\indent \indent Vezmi hranu $e_i \in \Delta(P)$

7.\indent \indent Nalezni trojúhelníky $t_1,t_2$ incidující s $e_i$.

8.\indent \indent if $(t_1 \cup t_2)$ konvexní a nelegální

9.\indent \indent \indent  Legalize $(t_1,t_2)$

10.\indent \indent \indent legal=false;
\newline
\hrule

\newpage
\subsection{Paprskovitý algoritmus}

Tento algoritmus je podobný tomu předchozímu, pouze využívá jiný postup, jak nalézt počáteční triangulaci $\Delta$. Na začátku se nalezne bod $p$ z množiny $P$, takový který je nejbližší jejímu středu. Po té jej paprskovitě spojíme se všemi zbývajícími body množiny $P$. Tyto body se následně seřadí podle orientace a vzdálenosti od bodu $p$ a v tomto pořadí se spojí hranami. Potom se vytvoří hrany na hranici triangulace. Vzniklá triangulace se dále postupně po jednotlivých hranách legalizuje stejně jako v předchozím případě.

\begin{figure}[h!]
\centering
\includegraphics[width=0.85\textwidth, angle=90]{img/rsweep.jpg}
\caption{Paprskovitý (Radial sweep) algoritmus, zdroj: \cite{triangulation}}
\label{fig:rsweep}
\end{figure}

\newpage
\subsection{Algoritmus inkrementálního vkládání}

Tento algoritmus je poměrně jednoduchý a snadný na implementaci, obzvlášť pokud je zvolena vhodná datová struktura. Jeho složitost je $0.(n^2)$, kterou lze úpravami zlepšit až na $0.(n.log(n))$. Tato metoda je tvořena třemi kroky. Na začátku je vytvořen konvexní obal množiny bodů $P$ a pro jeho lomové body se provede triangulace. Do vzniklé triangulace se postupně vkládají body z množiny $P$. Tato nově vzniklá triangulace nemusí být nutně DT a proto se provede ještě její legalizace.

\bigskip
\hrule
1.  Vytvoření konvexního obalu $\Omega$ nad množinou bodů $P$.

2.  Vytvoř DT pro lomové body konvexního obalu.

3.  Opakuj pro $i \in 1,...,n$

4.\indent  Přidej p do DT.

5.\indent  Najdi trojúhelník $t$ s vrcholy $p_i, p_j, p_k$ takový, že $p \in t$

6.\indent  Jestliže $p$ leží uvnitř $t$:

7.\indent \indent Přidání hrany $\overline{p,p_i}$.

8.\indent \indent Přidání hrany $\overline{p,p_j}$.

9.\indent \indent Přidání hrany $\overline{p,p_k}$.

10.\indent \indent Legalizace hrany $p,\overline{p_i,p_j},t$.

11.\indent \indent Legalizace hrany $p,\overline{p_j,p_k},t$.

12.\indent \indent Legalizace hrany $p,\overline{p_k,p_l},t$.

13.\indent Jinak jestliže $p$ leží na hraně $p_i, p_j$ trojúhelníků $t_1, t_2$:

14.\indent \indent Přidání hrany $\overline{p,p_i}$.

15.\indent \indent Přidání hrany $\overline{p,p_j}$.

16.\indent \indent Přidání hrany $\overline{p,p_k}$.

17.\indent \indent Přidání hrany $\overline{p,p_l}$.

18.\indent \indent Legalizace hrany $p,\overline{p_j,p_k},t$.

19.\indent \indent Legalizace hrany $p,\overline{p_k,p_i},t$.

20.\indent \indent Legalizace hrany $p,\overline{p_i,p_l},t$.

21.\indent \indent Legalizace hrany $p,\overline{p_l,p_j},t$.
\newline
\hrule

\newpage
\subsection{Algoritmus inkrementální konstrukce (Step-by-Step)}

Tento postup je založen na postupném přidávání bodů do již vytvořené DT, tvoří triangulaci postupně, trojúhelník po trojúhelníku. Na začátku jsou vybrány dva body$p_1, p_2$, které jsou sami sobě Voronoiovými sousedy a mezi nimi je vytvořena základní Delaunayova hrana $e$. K této hraně $e$ se hledá další bod 	$p$, tak aby vyhovoval kruhové podmínce a který společně s hranou $e$ vytvoří Delaunayův trojúhelník s vrcholy $p_1, p_2$ a $p$, který se zapíše do DT. Každá Delaunayovská hrana je orientována, bod $p$ hledáme pouze vlevo od ní.Pro konstrukci se používá modifikovaná datová struktura AEL (Active Edge List).Obsahuje hrany $e$, ke kterým hledáme body $p$, do struktury se neukládá topologický model (viz kapitola \ref{sec:data_struct}).

Základní vlastnost toho postupu je, že se v každém kroku ke stávající triangulaci připojí další bod a triangulaci tak rozšíří. Vznikající triangulace je už v procesu tvoření Delaunayova a není tedy třeba žádné následující optimalizace.

\bigskip
\hrule
1. $p_1$=náhodný bod z $P$, $p_2$=nejbližší bod k $p_1$.

2. Vytvoř hranu $\overline{e=p_1p_2}$

3. $p=d_D(e)$, bod s nejmenší Delaunay vzdáleností vlevo od $e$.

4. Pokud $p=NULL$, prohod’ orientaci $\overline{e=p_1p_2} \Rightarrow \overline{e=p_2p_1}$.

5. $e_2=\overline{p_2p}$, $e_3=\overline{pp_1}$.

6. Add $e, e_2, e_3$ do AEL.

7. while AEL not empty do:

9.\indent  $e=\overline{p_1p_2}$ první hrana AEL.

10.\indent  Změna orientace hrany $e=\overline{p_1p_2} \Rightarrow e=\overline{p_2p_1}$.

11.\indent  Bod $p$ s nejmenší Delaunay vzdáleností $d_D(e)$ vlevo od $e$.

12.\indent  if $p! =NULL:$

13.\indent \indent $e_2=\overline{p_2p}, e_3=\overline{pp_1}$.

14.\indent \indent Add $e, e_2, e_3$ do AEL.

15.\indent \indent Add $e$ do DT.

16.\indent pop(e)
\newline
\hrule

\newpage
\begin{figure}[h!]
\centering
\includegraphics[width=0.7\textwidth, angle=90]{img/stepbystep.jpg}
\caption{Algoritmus inkrementální konstrukce (Step-by-Step), zdroj: \cite{triangulation}}
\label{fig:stepbystep}
\end{figure}

\newpage
\subsection{Algoritmus Rozděl a panuj}

Rozděl a panuj je přístup, který vede k paralelizaci. Pro tvorbu Delaunayovské triangulaci nabízí nejlepší výsledky, co se výkonnosti týče. Tento přístup je založený na jednoduchých krocích:

1. Rekurzivní dělení množiny bodů $P$ až do stavu, kdy se pro podmnožinu nabízí jednoduché geometrické řešení. Při postupném dělení množiny $P$ se nakonec dostaneme do stavu, kdy nám zbudou buď tři body, v tom případě vytvoříme trojúhelník, nebo dva body, kdy vytvoříme hranu.
\begin{figure}[h!]
\centering
\includegraphics[width=0.48\textwidth, angle=90]{img/div_n_conq.jpg}
\caption{Rekurzivní dělení na dílčí podmnožiny, zdroj: \cite{triangulation}}
\label{fig:div_n_conq}
\end{figure}

2. Vytvoření prozatimní triangulace, která nemusí být Delaunayovská.

3. Připojení ke stávající triangulaci a její legalizace na Delaunayovskou. Právě propojování podmnožin na jednotlivých vrstvách je nejnáročnější část tohoto algoritmu.

\bigskip
Algoritmus Divide and Conquer využívá modul \emph{v.delaunay}, o kterém budeme mluvit později, viz Kapitola \ref{chap:v.delaunay}.

\newpage
\begin{figure}[h!]
\centering
\includegraphics[width=0.5\textwidth, angle=90]{img/merge.jpg}
\caption{Propojování dílčích triangulací, zdroj: \cite{triangulation}}
\label{fig:merge}
\end{figure}


\newpage
\section{Datové struktury}\label{sec:data_struct}

Existuje mnoho různých datových struktur pro uložení topologických informací o triangulační síti. Každá nabízí nějaké výhody a uživatel většinou musí řešit dva problémy. Jednak požadavky na dostatečnou kapacitu pro uložení dat a pak dostatečnou efektivitu při získávání informací ze struktury.

\begin{figure}[h!]
\centering
\includegraphics[width=0.9\textwidth]{img/struct_triangulace.png}
\caption{Příklad jednoduché triangulace}
\label{fig:struct_triangulace}
\end{figure}

\newpage
\subsection{Jednoduchá trojúhelníková struktura}
Tato struktura ukládá informace v nejjednodušší podobě. Pracuje pouze s trojicemi id jednotlivých vrcholů trojúhelníků v seznamu nebo v poli. Trojúhelníky jsou seřazeny vzestupně podle id, zatímco na pořadí uložených vrcholů nezáleží. Struktura je velmi nenáročná, co se požadavků na kapacitu týče, nicméně toto je vykoupené tím, že nemáme k dispozici žádnou informaci, který trojúhelník sousedí s kterým.

\begin{table}[h]
\catcode`\-=12
\begin{tabular}{|c||c|c|c|}
\hline
\multirow{2}{*}{Trojúhelník} & \multicolumn{3}{c|}{Vrcholy} \\ \cline{2-4} 
                             & i        & j       & k       \\ \hline \hline
1                            & 4        & 6       & 5       \\ \hline
2                            & 7        & 6       & 4       \\ \hline
3                            & 1        & 6       & 7       \\ \hline
4                            & 2        & 7       & 4       \\ \hline
5                            & 2        & 4       & 3       \\ \hline
6                            & 2        & 1       & 7       \\ \hline
\end{tabular}
\caption{Jednoduchá trojúhelníková struktura}
\label{tab:troj_struktura_simple}
\end{table}



\subsection{Trojúhelníková struktura se sousedy}

Tato struktura přináší rozšíření o informaci, s kterými trojúhelníky daný trojúhelník sousedí. K zapotřebí je tedy další seznam, který obsahuje id trojúhelníku.

\begin{table}[h]
\catcode`\-=12
\begin{tabular}{|c||c|c|c||c|c|c|}
\hline
\multirow{2}{*}{Trojúhelník} & \multicolumn{3}{|c|}{Vrcholy} & \multicolumn{3}{|c|}{Sousedé}      \\ \cline{2-7} 
                             & i        & j       & k       & $t_{j,k}$ & $t_{k,i}$ & $t_{i,j}$ \\ \hline \hline
1                            & 4        & 6       & 5       & -         & -         & 2         \\ \hline
2                            & 7        & 6       & 4       & 1         & 4         & 3         \\ \hline
3                            & 1        & 6       & 7       & 2         & 6         & -         \\ \hline
4                            & 2        & 7       & 4       & 2         & 5         & 6         \\ \hline
5                            & 2        & 4       & 3       & -         & -         & 4         \\ \hline
6                            & 2        & 1       & 7       & 3         & 4         & -         \\ \hline
\end{tabular}
\caption{Trojúhelníková struktura se sousedy}
\label{tab:troj_strukt_sous}
\end{table}

\subsection{Vertex-based struktura se sousedy}

Vertex-based struktura se sousedy je poměrně úsporná struktura, co se objemu dat týče. Ke každému vrcholu $v_i$ v síti jsou uloženy do seznamu sousedů vrcholy, které jsou s ním spojené. V případě že $v_i$ leží na konvexním obalu je seznam sousedů ukončen 'pseudovrcholem'. 

\begin{table}[h]
\catcode`\-=12
\begin{tabular}{|c||c|c|c|c|c|c||c|}
\hline
Vrchol & \multicolumn{6}{|c|}{Sousední vrcholy} & Suma vrcholů \\ \hline \hline
1      & 6    & 7    & 2    & 0    &     &     & 4            \\ \hline
2      & 1    & 7    & 4    & 3    & 0   &     & 9            \\ \hline
3      & 2    & 4    & 0    &      &     &     & 12           \\ \hline
4      & 3    & 2    & 7    & 6    & 5   & 0   & 18           \\ \hline
5      & 4    & 6    & 0    &      &     &     & 21           \\ \hline
6      & 5    & 4    & 7    & 1    & 0   &     & 26           \\ \hline
7      & 6    & 4    & 2    & 1    &     &     & 30           \\ \hline
\end{tabular}
\caption{Vertex based struktura}
\label{tab:vertex_based}
\end{table}

\begin{figure}[h!]
\centering
\includegraphics[width=0.6\textwidth, angle=90]{img/pseudo_node.jpg}
\caption{Datová struktura s použitím pseudo-uzlu, zdroj: \cite{triangulation}}
\label{fig:pseudo_node}
\end{figure}

\newpage
\subsection{Half-edge datová struktura}

Tato struktura uchovává topologický model na základě orientovaných polovičních hran. Princip je rozdělit každou hranu na dvě orientované \emph{půl-hrany}, z nichž každá směřuje opačným směrem. Každému trojúhelníku můžeme tak přiřadit tři půl-hrany, které jsou orientované v protisměru hodinových ručiček. Každá půl-hrana začíná ve \emph{startovním vrcholu} a směřuje do \emph{cílového vrcholu}. V half-edge struktuře si každá půl-hrana uchovává pointer na svůj startovní bod, na následující půl-hranu, patřící stejnému trojúhelníku a nakonec pointer na opačně orientovanou hranu, tzv. \emph{twin-edge}. Pointer na twin-edge hranu nemají pouze půl-hrany ležící na konvexním obalu triangulace.

\begin{figure}[h!]
\centering
\includegraphics[width=0.9\textwidth]{img/half_edge.png}
\caption{Half-edge struktura (Zdroj: http://pointclouds.org/blog/nvcs/martin/index.php)}
\label{fig:half_edge}
\end{figure}

Z half-edge struktury je možné odvodit mnohé jiné příbuzné struktury obsahující další informace o topologii, které ulehčují procházení celou sítí při vyhledávání, ale zároveň zvyšují nároky na kapacitu. Mezi tyto příbuzné struktury patří například \emph{vertex-edge}, \emph{face-edge} nebo \emph{winged edge} datová struktura, kterou používá například modul \emph{v.delaunay} v GRASS GISu.

\newpage
\begin{figure}[h!]
\centering
\includegraphics[width=0.35\textwidth, angle=90]{img/half_edge.jpg}
\caption{Half-edge struktura, zdroj: \cite{triangulation}}
\label{fig:half_edge_scan}
\end{figure}
\begin{table}[h!]
\catcode`\-=12
\begin{tabular}{|c||c||c|c|}
\hline
\multirow{2}{*}{Půl-hrana} & \multirow{2}{*}{Startovní vrchol} & \multicolumn{2}{c|}{Half-edge pointry} \\ \cline{3-4} 
                           &                                   & Další hrana v trojúhelníku & Twin-edge \\ \hline
1                          & 2                                 & 2                          & -         \\ \hline
2                          & 1                                 & 3                          & 18        \\ \hline
3                          & 7                                 & 1                          & 4         \\ \hline
4                          & 2                                 & 5                          & 3         \\ \hline
5                          & 7                                 & 6                          & 12        \\ \hline
6                          & 4                                 & 4                          & 7         \\ \hline
7                          & 2                                 & 8                          & 6         \\ \hline
8                          & 4                                 & 9                          & -         \\ \hline
9                          & 3                                 & 7                          & -         \\ \hline
10                         & 7                                 & 11                         & 17        \\ \hline
11                         & 6                                 & 12                         & 13        \\ \hline
12                         & 4                                 & 10                         & 5         \\ \hline
13                         & 4                                 & 14                         & 11        \\ \hline
14                         & 6                                 & 15                         & -         \\ \hline
15                         & 5                                 & 13                         & -         \\ \hline
16                         & 1                                 & 17                         & -         \\ \hline
17                         & 6                                 & 18                         & 10        \\ \hline
18                         & 7                                 & 16                         & 2         \\ \hline
\end{tabular}
\caption{Half-edge struktura}
\label{tab:half_edge}
\end{table}

\newpage
\begin{lstlisting}[caption={Definice datové struktury}]
class Half-edge
{
	Point *originating_vertex
	Half-edge *edge *next_edge *twin_edge
	
};
\end{lstlisting}

\subsection{Dart-based datová struktura}
Dart-based datová struktura nabízí extrémně rychlé procházení topologie napříč datovou strukturou. Ta může být representována jako množina šipek $D$, kde každá šipka $d \in D$ odkazuje k jednomu vrcholu a třem dalším šipkám z $D$, definovaných jako iterátory $\alpha_0, \alpha_1 a \alpha_2$. 
\todo[inline]{Vložit obrázek iterátorů, odstavec o nich}

\newpage
\begin{figure}[h!]
\centering
\includegraphics[width=0.5\textwidth, angle=90]{img/dart_struct.jpg}
\caption{Dart-based datová struktura, zdroj: \cite{triangulation}}
\label{fig:dart_struct}
\end{figure}

\begin{table}[h!]
\catcode`\-=12
\begin{tabular}{|c||c|c|c|c|}
\hline
\multirow{2}{*}{Šipka d} & \multicolumn{4}{c|}{Šipkové pointery} \\ \cline{2-5} 
                         & Vrchol &$\alpha_0$ & $\alpha_1$ & $\alpha_2$      \\ \hline
1                        & 1          & 2      & 6      & 1      \\ \hline
2                        & 6          & 1      & 3      & 2      \\ \hline
3                        & 6          & 4      & 2      & 12     \\ \hline
4                        & 7          & 3      & 5      & 11     \\ \hline
5                        & 7          & 6      & 4      & 17     \\ \hline
6                        & 1          & 5      & 1      & 18     \\ \hline
7                        & 6          & 8      & 12     & 13     \\ \hline
8                        & 4          & 7      & 9      & 14     \\ \hline
9                        & 4          & 10     & 8      & 15     \\ \hline
10                       & 7          & 9      & 11     & 16     \\ \hline
11                       & 7          & 12     & 10     & 4      \\ \hline
12                       & 6          & 11     & 7      & 3      \\ \hline
\end{tabular}
\caption{Dart based struktura}
\label{tab:dart_based}
\end{table}

\newpage
\section{Interpolace metodou přirozeného souseda}

Interpolace metodou přirozeného souseda je deterministická interpolační metoda pro prostorová data. Poskytuje spojitý, vyhlazený výstup, bez extrapolovaných hodnot. 

Pro výpočet vah využívá Voronoiových diagramů. Do VD pro měřené body vkládá body určené k interpolaci. Vložením nového bodu dojde v jeho okolí k přetvoření VD. K vypočtení váhy se používá jak VD před vložením bodu, tak VD po vložení bodu. Voronoiova buňka nově vloženého bodu překrývá několik buněk z původního VD. Právě tento překryv, který nově vložený bod "ukradne" z plochy původních buněk slouží k výpočtu váhy pro interpolaci.

\bigskip
Matematicky tedy můžeme zapsat:
\newline
$$V(p)=\sum_{i=1}^n V_i$$

kde $V(p)$ je plocha nově vloženého bodu a $V_i$ je část plochy původních buněk, o kterou byly vložením buňky "okradeny".

\bigskip
Váha pro jednotlivé sousedy se vypočte:
\newline
$$\lambda_i = \frac{V_i}{\sum_{i=1}^n V_i}$$

\bigskip
A konečně samotná hodnota pro interpolovaný bod není nic jiného než vážený průměr:
\newline
$$G(x,y) = \sum_{i=1}^{n} \lambda_i  f(x_i, y_i)$$

\newpage
\begin{figure}[h!]
\centering
\includegraphics[width=0.9\textwidth]{img/canvas_0.png}
\caption{Původní VD}
\label{fig:fig:canvas0}
\end{figure}

\begin{figure}[h!]
\centering
\includegraphics[width=0.9\textwidth]{img/canvas_1.png}
\caption{Ukradené plochy}
\label{fig:fig:canvas1}
\end{figure}

\newpage
Na Obrázku \ref{fig:fig:canvas1} vidíme, že nově vzniklá buňka "ukradla" nejvíce plochy ze žlutého polygonu, nejméně ze zeleného. Při výpočtu funkční hodnoty vloženého bodu bude mít tedy hodnota žlutého polygonu největší váhu, zatímco hodnota zeleného bodu váhu nejmenší.\footnote{Vytvořeno pomocí http://alexbeutel.com/webgl/voronoi.html}
\begin{figure}[h!]
\centering
\includegraphics[width=0.9\textwidth]{img/canvas_2.png}
\caption{Nově vzniklý VD}
\label{fig:fig:canvas2}
\end{figure}


\newpage	
\part{Praktická část}

\newpage
\section{Postup řešení}
\subsection{Bash}
Při řešení otázky, jak implementovat metodu přirozeného souseda pro GRASS 7, jsem vycházel z modulu napsaného pro GRASS GIS 6, který jsem měl k dispozici. Jednalo se o modul \emph{v.surf.nnbathy} pro vektorová data. Tento modul byl napsán v Bashi. Pro novou verzi GRASS GISu 7, ve které si vývojáři kladou za cíl zpřístupnit tento software širší veřejnosti, tento modul v Bashi ovšem nebylo možno použít, neboť do nové verze se počítá pouze s moduly v jazyce Python a C.

\subsubsection{v.surf.nnbathy}\footnote{\url{http://svn.osgeo.org/grass/grass-addons/grass6/raster/v.surf.nnbathy/description.html}}
\emph{v.surf.nnbathy} je modul napsaný v bashi. Slouží jako interface mezi \emph{nnbathy} z externí knihovny \emph{nn-c} a GRASS GISem. \emph{v.surf.nnbathy} nabízí celkem tři algoritmy interpolace. Defaultně je nastaven \emph{Watsonův algoritmus 	pro Sibsonovu interpolaci}. Další možností je \emph{Delaunayova triangulace} a poslední \emph{Bělikovův a Semenovův algoritmus pro nesibsonovu interpolaci}. Pro Delaunayvou triangulaci, která je základem pro všechny tři algoritmy, se využívá knihovny \emph{Triangle} napsanou Jonathanem Richardem Schewchukem. Parametry pro spuštění modulu jsou tyto (nepovinné v hranatých závorkách):
\begin{description}
\item[output] Proměnná typu \emph{string}, název výstupní rastrové mapy, jediný povinný parametr.
\item[input] Proměnná typu \emph{string}, název vstupní vektorové mapy.
\item[[file]] Proměnná typu \emph{string}, název vstupního souboru.
\item[[zcolumn]] Proměnná typu \emph{string}, název sloupce z atributové tabulky, jehož data budou použity pro interpolaci.
\item[[layer]] Proměnná typu \emph{integer}, nastavení, zda se jedná od 2D nebo 3D vektorová data.
\item[[where]] Proměnná typu \emph{string}, SQL where podmínka.
\item[[alg]] Proměnná typu \emph{string}, název použitého algoritmu.
\end{description}

\bigskip
\todo[inline]{nastaveni listing}

Volání v příkazové řádce pak může vypadata například takto:
\begin{lstlisting}[caption={bash version}]
user@my_comp:~$ v.surf.nnbathy input=elevation_lid792_randpts@PERMANENT output=raster_map zcolumn=value alg=nn
\end{lstlisting}

%r.surf v bashi
\begin{comment}
\subsubsection{r.surf.nnbathy}\footnote{\url{http://svn.osgeo.org/grass/grass-addons/grass6/vector/r.surf.nnbathy/description.html}}
Modul \emph{r.surf.nnbathy} pracuje na podobném principu jako modul \emph{v.surf.nnbathy}, jen pro rastrová data. Při volání je možnost použít méně parametrů.
\begin{description}
\item[output] Proměnná typu \emph{string}, název výstupní rastrové mapy, jediný povinný parametr.
\item[input] Proměnná typu \emph{string}, název vstupní vektorové mapy.
\item[[alg]] Proměnná typu \emph{string}, název použitého algoritmu.
\end{description}

Volání v příkazové řádce pak může vypadata například takto:
\begin{lstlisting}[language=bash,caption={bash version}]
user@my_comp:~$ v.surf.nnbathy input=elevation_lid792_randpts@PERMANENT output=raster_map zcolumn=value alg=nn
\end{lstlisting}
\end{comment}

\newpage
\subsection{Python}
Jako první krok pro implementaci interpolace přirozeného souseda pro GRASS GIS 7 bylo potřeba stávající modul v bashi přepsat do podporovaného programovacího jazyka. Pro verzi 7 bylo možné napsat moduly buďto v jazyce C nebo Python. Z důvodu nepříliš velké zkušenosti v programování byl pro začátek zvolen jazyk Python, který je pro méně zkušené programátory vice přívětivý. 

\subsubsection{v.surf.nnbathy.py}

V následující části této práce bude popsáno jak pythoní modul funguje, jaká jsou vstupní a výstupní data, jaké vytváří dočasné soubory.

\paragraph{Vstupní data}
Stejně jako původní bashový modul, i tento modul pracuje se vstupními daty buď v podobě textového ASCII souboru nebo vektorové mapy. 

V případě použití vstupní vektorové mapy s body je pak při volání modulu použit parametr \emph{zcolumn}, který určuje z jakého sloupce atributové tabulky se budou brát hodnoty k interpolaci.

\begin{figure}[h!]
\centering
\includegraphics[width=0.9\textwidth]{img/vstup_vect_map.png}
\caption{Vektorová mapa na vstupu}
\label{fig:vstup_vect_map}
\end{figure}

\newpage
Druhou možností je použít textový ASCII soubor, který musí obsahovat $n$ bodů na $n$ řádcích ve třech sloupcích. V prvních dvou sloupcích je uložen údaj o poloze v podobě x a y souřadnice. Ve třetím sloupci jsou pak uloženy hodnoty veličiny, kterou chceme interpolovat.

%ukazka TMPXYZ
\begin{lstlisting}[caption={Příklad vstupního souboru}]
639524.309 221227.596 112.191 101960
639529.088 221223.045 112.225 101961
639529.152 221219.826 112.029 102115
639524.303 221224.435 112.212 102116
639519.444 221229.043 111.752 102117
639513.546 221229.699 111.472 102440
639518.307 221225.172 111.874 102441
639523.114 221220.597 112.243 102442
\end{lstlisting}

\bigskip
\paragraph{Funkce region()}
Každá operace prováděná v GRASS GISu je prováděna pouze na určitém rozsahu území, tzv. \emph{výpočetním regionu}. \emph{Výpočetní region} je určen jako obdélník daný mezními kartografickými souřadnicemi a počtem řádků a sloupců. 
Funkce \emph{region()} všechna nastavení uloží do proměných. Dále vypočte plochu výpočetního regionu. Na rozdíl od GRASS GISu, který jako mezní kartografické souřadnice bere vnější rohy rohových buněk obdélníku, knihovna \emph{nn-c} používá středy rohových buněk, a proto je třeba nastavení výpočetního regionu opravit o rozlišení buněk.

\bigskip
\paragraph{Funkce initials\_controls()}
Ve chvíli, kdy je nastavený výpočetní region,můžeme provést úvodní kontroly a přípravy před samotným výpočtem. Zejména zda plocha výpočetního regionu není nulová a je kde provádět interpolaci. Dále je třeba zajistit jednoznačné určení vstupních dat, tedy zda se bude pracovat s ASCII souborem nebo vektorovou mapou, a jejich kontrolu, popřípadě SQL podmínku. Také kontrolujeme zda z knihovny \emph{nn-c} máme nainstalovaný program \emph{nnbathy}, který interpolaci provádí. Také je třeba vytvořit dočasné pomocné soubory, které využijeme při práci s daty. 

V případě, že pracujeme s vektorovou mapu, uložíme informace o bodových datech do dočasného proměnné \emph{TMPcat} pomocí modulu \emph{v.out.ascii}. Výstupem toho modulu je ASCII soubor o $n$ řádcích a čtyřech sloupcích. V prvních dvou sloupcích je uložená poloha bodu, ve třetím jeho id a ve čtvrtém hodnota k interpolaci. 

\bigskip
%ukazka souboru TMPcat
\lstset{basicstyle=\footnotesize}
\begin{lstlisting}[caption={Pomocný soubor TMPcat}]
638234.122902785427868 221198.4894384436775   1 62.817782000000001
638755.665974545176141 220976.783764891704777 2 9.190488000000000
638729.530741120455787 219988.669646041787928 3 91.799952000000005
638088.941303733270615 220228.186909802345326 4 76.839046999999994
638158.578729554312304 220794.514421981060877 5 2.037001000000000
637781.724264170858078 219988.193243810994318 6 8.298977000000001
638359.847223712014966 220692.375897407706361 7 15.550326000000000
639137.670258715632372 221096.622500944242347 8 16.613054999999999
\end{lstlisting}

Jelikož id bodu k dalším výpočtům nepotřebujeme do dočasné proměnné \emph{TMPYZ} si uložíme pouze informace o poloze a hodnotu k interpolaci. V případě, že nepracujeme s vektorovou mapou, ale ASCII souborem, tak tento soubor rovnou uložíme do proměnné \emph{TMPXYZ}.

\bigskip
%ukazka souboru TMPxyz
\lstset{basicstyle=\footnotesize}
\begin{lstlisting}[caption={Pomocný soubor TMPXYZ}]
638234.122902785427868 221198.489438443677543 62.817782000000001
638755.665974545176141 220976.783764891704777 9.190488000000000
638729.530741120455787 219988.669646041787928 91.799952000000005
638088.941303733270615 220228.186909802345326 76.839046999999994
638158.578729554312304 220794.514421981060877 2.037001000000000
637781.724264170858078 219988.193243810994318 8.298977000000001
638359.847223712014966 220692.375897407706361 15.550326000000000
639137.670258715632372 221096.622500944242347 16.613054999999999
\end{lstlisting}

\bigskip
\paragraph{Funkce compute()}
V této části kódu je volán program \emph{nnbathy} s následujícími vstupními paramatry:
\begin{description}
\item[-w]{proměnná typu double, omezuje extrapolaci přiřezením minimální váhy pro vrchol Delaunayovi sítě. V našem případě nastavena nula, což zamezuje extrapolaci.}
\item[-i]{proměnná typu string, název vstupního souboru o $n$ řádcích, se třemi sloupci, x a y souřadnicí a hodnotou k interpolaci}
\item[-x]{dvojice $x_min$, $x^max$ typu double, mezní hodnoty výstupní mřížky}
\item[-y]{dvojice $x_min$, $x^max$ typu double, mezní hodnoty výstupní mřížky}
\item[-P]{proměnná typu string, použitá metoda interpolace}
\item[-n]{dvojice double x double, rozlišení výstupní mřížky}
\end{description}

Výstupem z \emph{nnbathy} je soubor \emph{XYZout}. Obsahuje data o výstupní mřížce buňku po buňce ve třech sloupcích. V prvních dvou jsou x a y souřadnice, ve třetím vyinterpolovaná hodnota. V případě buňek mimo oblast, kde probíhala interpolace, je ve třetím sloupci uložena hodnota NaN.

\bigskip
%ukazka XYZout
\lstset{basicstyle=\footnotesize}
\begin{lstlisting}[caption={XYZout}]
637725 221045 NaN
637735 221045 NaN
637745 221045 NaN
637755 221045 NaN
637765 221045 NaN
637775 221045 23.2274425578696
637785 221045 20.3234644594092
637795 221045 23.6841650075168
\end{lstlisting}

\bigskip
\paragraph{Funkce convert()}
Výstupní textový soubor z \emph{nnbathy} je třeba upravit, aby s ním bylo možné dále pracovat v GRASS GISu. Pro další práci slouží dočasný soubor \emph{TMP}. Při vytváření na začátku tohoto souboru vznikne hlavička, která obsahuje data o hranicích, rozlišení, typu a hodnotě null.

\bigskip
%Ukázka hlavičky
\lstset{basicstyle=\ttfamily}
\begin{lstlisting}[caption={Hlavička souboru TMP}]
north: 228495.0
south: 215005.0
east: 644995.0
west: 630005.0
rows: 1350
cols: 1500
type: double
null: NaN
\end{lstlisting}

Dále je potřeba vybrat vyinterpolované hodnoty jednotlivých buněk ze souboru \emph{XYZout}, kde jsou uloženy ve třetím sloupci na samostatných řádcích, a vložit je do souboru \emph{TMP} v pravidelné mřížce.

%ukázka souboru TMP
\todo[inline]{Vložit TMP soubor ukázku}
\lstset{basicstyle=\footnotesize}
\begin{lstlisting}
\end{lstlisting}

\paragraph{Funkce import\_to\_raster()}
Soubor \emph{TMP}, ve kterém máme uložené vyinterpolované hodnoty v pravidelné mřížce, slouží jako vstupní soubor pro modul \emph{r.in.ascii}, který tyto hodnoty převedu do rastru. Dále je použit modul \emph{r.support}, který uloží příkazy do rastrových metadat. Na závěr je vytištěna zpráva, že byla vytvořena rastrová mapa.


\paragraph{Výstupní data}
Výstupem modulu \emph{v.surf.nnbathy} je rastrová mapa.
\begin{figure}[h!]
\centering
\includegraphics[width=0.9\textwidth]{img/vystup_rast_map.png}
\caption{Výstupní rastrová mapa}
\label{fig:vystup_rast_map}
\end{figure}

\newpage
\subsection{OOP}
V průběhu práce na přidání pythoního modulu \emph{v.surf.nnbathy} jsem zjistil, že v GRASS GISu verze 6 je k dispozici také bash modul \emph{r.surf.nnbathy}, který pracuje s rastrovými daty. Jelikož větší část kódu byla pro moduly v.surf.nnbathy a r.surf.nnbathy společná, rozhodl jsem se hlavní výpočetní část spojit. Na místo dvou procedurálních modulů byla objektově vytvořena knihovna \emph{nnbathy.py} a dva moduly \emph{v.surf.nnabthy.py} pro vektorová data a \emph{r.surf.nnbathy.py} pro data rastrová, které knihovnu \emph{nnbathy} volají.

\subsubsection{v.surf.nnbathy}
V objektově orientovaném modulu pro vektorová data, tak zůstaly úvodní část, která automaticky generuje GUI, úvodní vstupní kontroly a dále if podmínka, která vyhodnocovala, zda vstupují vektorová data v podobě vektorové mapy nebo ASCII souboru.



\subsubsection{r.surf.nnbathy}
Modul \emph{r.surf.nnbathy} pracuje na podobném principu jako modul \emph{v.surf.nnbathy}, jen pro rastrová data. Při volání je možnost použít méně parametrů.
\begin{description}
\item[output] Proměnná typu \emph{string}, název výstupní rastrové mapy, jediný povinný parametr.
\item[input] Proměnná typu \emph{string}, název vstupní vektorové mapy.
\item[[alg]] Proměnná typu \emph{string}, název použitého algoritmu.
\end{description}


I v tomto modulu zůstala část, která vytváří GUI. Protože ale modul pracuje s daty pouze v podobě rastrové mapy, nebyly potřeba žádně vstupní kontroly ani if podmínka.

\newpage
\subsubsection{nnbathy}
V knihovně nnbathy, které oba moduly volají tedy zůstala hlavní výpočetní část kódu. 

\paragraph{Rodičovská třída Nnbathy} V rodičovské třídě NNbathy bylo vytvořeno několik objektů, které přebraly funkce jednotlivých procedur z předchozího kódu. Navíc byly vytvořeny tyto objekty:

\paragraph{Objekt \_\_init\_\_}
V tomto objektu se inicializují dočasné soubory a volá objekt region().

\paragraph{Objekt \_\_del\_\_}
Tento objekt slouží k odstranění dočasných souborů.

\paragraph{Třída Nnbathy\_raster}
Tato třída slouží pro rastrová vstupní data a je dědičná z rodičovské třídy Nnbathy.

\paragraph{Třída Nnbathy\_vector}
Tato třída slouží pro vektorová vstupní data a je dědičná z rodičovské třídy Nnbathy.

\paragraph{Třída Nnbathy\_file}
Tato třída slouží pro vstupní data v podobě ASCII souboru a je dědičná z rodičovské třídy Nnbathy.

\newpage
\section{Možnosti budoucí implementace}
V současné době jsou oba moduly k dispozici v rámci balíčků Add-Ons\footnote{http://grass.osgeo.org/download/addons/}. V adresáři \emph{GRASS7/vector/v.surf.nnbathy} můžeme  naleznout hlavní knihovnu \emph{nnbathy.py}, modul \emph{v.surf.nnbathy.py} a dokumentaci \emph{v.surf.nnbathy.html}. 

V adresáři \emph{GRASS7/raster/r.surf.nnbathy} naopak nalezneme modul \emph{r.surf.nnbathy.py} a jeho dokumentaci \emph{v.surf.nnbathy.html}. Oba moduly je možné instalovat do GRASS GISu 7, pomocí modulu \emph{g.extention} nebo pomocí GUI.

\bigskip
\begin{lstlisting}[caption={Stáhnutí modulu v.surf.nnbathy pomocí g.extention}]
g.extension extension=v.surf.nnbathy
\end{lstlisting}

\bigskip
Cílem do budoucna však není nechat tyto moduly pouze v rámci Add-Ons. Jelikož interpolace metodou přirozeného souseda poskytuje spojité, hladké výstupy bez extrapolovaných hodnot může být její použití v praxi poměrně využívané. Právě proto je snaha dostat tento interpolační nástroj do základní distribuce GRASS GISu. Tomu však brání vnitřní závislost na knihovně Triangle, která nespadá pod volně šiřitelnou licenci GNU GPL. V následujících kapitolách rozebereme možnosti vyhnutí se této knihovně a možnostem, které se do budoucna nabízejí.

\newpage
\subsection{Knihovna Triangle}
Knihovna Triangle verze 1.4\footnote{http://www.cs.cmu.edu/~quake/triangle.html} byla napsaná Jonathanem Richardem Shewchuk v roce 2002. Je distribuována pod licencí MIT, která nedovoluje začlenění do oficiální distribuce GRASS GISu. V programu \emph{nnbathy} má na starosti Delaunayovu trinagulaci. Je tedy třeba najít vhodný způsob, jak tuto knihovnu nahradit.

Triangle pro tvorbu triangulace využívá Divide and Conquer algoritmu v kombinaci Inkrementálním algoritmem. Pro ukládání dat využívá svoji vlastní, poměrně obsáhlou datovou strukturu \emph{delaunay}, do které si ukládá hraniční body regionu, všechny body triangulace, všechny trojúhelníky s hranami a jejich opsanými kružnicemi, včetně jejich sousedů. 

Tuto datovou strukturu delaunay dále využívá i samotný program \emph{nnbathy}, který provádí interpolaci metodou přirozeného souseda. Právě převod na tuto datovou strukturu bude v budoucnosti klíčový v případě, že se podaří najít vhodný triangulační nástroj, který nahradí knihovnu Triangle.

\subsection{Knihovna CGAL}
Knihovna CGAL (The Computational Geometry Algorithms Library) je projekt, který poskytuje snadný přístup k efektivním a spolehlivým geometrickým algoritmům ve formě C++ knihovny. CGAL se používá v různých oblastech, které potřebují geometrické výpočty, jako např. v GISech, CADu, molekulární biologii, počítačové grafice a robotice. Jeden z jeho balíčků se přímo zabývá interpolací a nabízí funkce pro výpočet souřadnic přirozeného souseda. Tato knihovna je třeba ještě dále prozkoumat a zjistit její možnosti, neboť možnost její budoucí implementace do GRASS GISu se nejeví nereálně.

\newpage
\subsection{Modul \emph{v.delaunay}}
\label{chap:v.delaunay}
Modul \emph{v.delaunay}\footnote{http://grass.osgeo.org/grass71/manuals/v.delaunay.html} je součást oficiální distribuce GRASS GISu. Tento modul poskytuje Delaunayovu triangulaci nad vektorovou mapou s body nebo centroidy. 

Ovládání modulu je velmi jednoduché na výběr máme pouze z několika flagů a několika paramatrů:

\bigskip
Flagy:
\begin{description}
\item[-r] Počítej pouze s body v aktuálním regionu.
\item[-l] Vytvoř výstupní triangulaci pomocí linií, ne ploch.
\end{description}
\bigskip
Parametry:
\begin{description}
\item[[input]] Povinný parametr. Název vstupní vektorové mapy.
\item[layer] Název nebo číslo vrstvy. Slouží k připojení do databáze.
\item[[output]] Povinný parametr. Název výstupní vektorové mapy.
\end{description}

\begin{lstlisting}[caption={Volání modulu v.delaunay z příkazové řádky}]
v.delaunay input=elev_lid792_randpts output=elev_lid792_randpts_delaunay
\end{lstlisting}

\todo[inline]{Vložit obrázek bodů a triangulace}

Pro vytvoření triangulace používá modul algoritmus Rozděl a panuj. Data ukládá do datové struktury half-edge. Z hlediska rychlosti se tento modul jeví jako adekvátní náhrada za knihovnu Triangle. Při testech bylo dokázáno, že pro náhodné konfigurace miliónu bodů dokáže triangulaci provést za méně než 15 s, což se jeví jako dostatečně efektivní.

Zbývající otázkou pro jeho použití do budoucnosti je tedy převod datové struktury half-edge na datovou strukturu, kterou využívá program nnbathy, tedy strukturu delaunay.


\newpage
\section{Srovnání GRASS GIS a ArcGIS}

V následující kapitole se budeme věnovat srovnání GRASS GISu a ArcGISu při interpolaci metodou přirozeného souseda. GRASS GIS bude zastupovat modul \emph{v.surf.nnbathy}, o kterém byla řeč v předchozích kapitolách. Za ArcGIS budeme zkoumat nástroj \emph{Natural Neighbour}, který se nachází v toolboxu Spatial Analyst. 

Pro porovnání byly zvoleny tři situace. Na území o velikosti deset krát deset kilometrů, s rozlišením buňky deset metrů byly vygenerována bodová pole o počtu tisíc, sto tisíc a milion bodů. Nad těmito soubory byla po té provedena interpolace v obou softwarech. Interpolace byla pro každou datovou sadu provedena v deseti opakováních, výsledný čas je průměrem. Testy byly provedeny na notebooku HP Pavilion dv6000 s procesorem Intel\copyright  Core\texttrademark 2 Duo CPU T5550 @ 1.83GHz $\times$ 2 a RAM pamětí 4 GB. Výsledky jsou uvedeny v Tabulce \ref{tab:GRASSxArc}.

\bigskip
\begin{table}[h]
\catcode`\-=12
\begin{tabular}{|c|c|c|}
\hline
Počet bodů & GRASS GIS  & ArcGIS     \\ \hline
1000       & 13,5 s     & 7,6 s      \\ \hline
100000     & 58,9 s     & 14,1 s     \\ \hline
1000000    & 8 min 25 s & 1 min 24 s \\ \hline
\end{tabular}
\caption{Porovnání časů}
\label{tab:GRASSxArc}
\end{table}

\newpage
\begin{figure}[h!]
\centering
\begin{floatrow}
\ffigbox{\includegraphics[width=0.48\textwidth]{img/body_1000.png}}{\caption{ArcGIS: Výstupní rastr pro 1000 bodů}}{\label{fig:b1000_Arc}}
\ffigbox{\includegraphics[width=0.48\textwidth]{img/body_1000_grass.png}}{\caption{GRASS GIS: Výstupní rastr pro 1000 bodů}}{\label{fig:b1000_grass}}
\end{floatrow}
\end{figure}

\begin{figure}[h!]
\centering
\begin{floatrow}
\ffigbox{\includegraphics[width=0.48\textwidth]{img/body_100000.png}}{\caption{ArcGIS: Výstupní rastr pro 100000 bodů}}{\label{fig:b100000_Arc}}
\ffigbox{\includegraphics[width=0.48\textwidth]{img/body_100000_grass.png}}{\caption{GRASS GIS: Výstupní rastr pro 100000 bodů}}{\label{fig:b100000_grass}}
\end{floatrow}
\end{figure}

\newpage
\begin{figure}[h!]
\centering
\begin{floatrow}
\ffigbox{\includegraphics[width=0.48\textwidth]{img/body_mil_grass.png}}{\caption{ArcGIS: Výstupní rastr pro 1000000 bodů}}{\label{fig:b_mil_Arc}}
\ffigbox{\includegraphics[width=0.48\textwidth]{img/body_mil_grass.png}}{\caption{GRASS GIS: Výstupní rastr pro 1000000 bodů}}{\label{fig:b_mil_grass}}
\end{floatrow}
\end{figure}

\newpage
\necislovana{Seznam použitých zkratek}

\begin{tabular}{ll}
\textbf{DMT}& Digitální model terénu\\
\textbf{DT}& Delaunayova triangulace\\
\textbf{DPZ}& Dálkový průzkum Země\\
\textbf{GIS}& Geographic Information System (Geografický informační systém)\\
\textbf{GNU GPL}& GNU General Public License\\
\textbf{GRASS}& Geographical Resources Analysis Support System\\
\textbf{HW}& Hardware\\
\textbf{OS}& Operační systém\\
\textbf{QGIS}& Quantum GIS\\
\textbf{GUI}& Graphical User Interface (Grafické uživatelské rozhraní)\\
\textbf{USA-CERL}& US Army Construction Engineering Research Laboratories\\
\textbf{VD}& Voronoiův diagram\\
\end{tabular}


\newpage
\renewcommand\baselinestretch{1.2}
\selectfont
\renewcommand{\refname}{Použité zdroje}
\phantomsection
\addcontentsline{toc}{section}{\refname}

\begin{thebibliography}{99}
\label{literatura}


\bibitem{triangulation}
HJELLE, Øyvind; DÆHLEN, Morten. \textit{Triangulations and applications}. Berlin: Springer, 2010. 234 s. ISBN 978-3-642-06988-8.


\bibitem{grafika}
SOCHOR, Jiří; Žára, Jiří. \textit{Algoritmy počítačové grafiky}. Praha: České vysoké učení technické, 1994. 258 s. ISBN 978-8-001-00949-9.


\bibitem{script}
GRASS Development Team. \textit{GRASS 7 Programmer's Manual} [online].
c2000-2011, generated on Sat Apr 16 2011 [cit. 2011-03-19].
URL: \textless\url{http://grass.osgeo.org/programming7}\textgreater


\bibitem{trac}
\textit{GRASS GIS Tracker and Wiki} [online]. Last modified 12 April 2011
[cit. 2011-04-20].
URL: \textless\url{http://trac.osgeo.org/grass}\textgreater


\bibitem{ArcCR500}
ARCDATA PRAHA, s.r.o. \textit{ARCDATA PRAHA - ArcČR 500} [online].
c1992–2006 ARCDATA PRAHA, s.r.o., poslední změna: 7. 12. 2007 [cit. 2011-04-23].
URL: \textless
\url{http://old.arcdata.cz/data/arccr} \textgreater

\bibitem{rukovet}
NETELER, Markus. \textit{Praktická rukověť ke geografickému informačnímu systému GRASS} [online].
URL: \textless\url{http://geo.fsv.cvut.cz/data/grasswikicz/grass_prirucka/grass_prirucka_0.4.pdf}
\textgreater

\bibitem{TB1}
BAYER, Tomáš. \textit{Rovinné triangulace a jejich využití} [online].
URL: \textless\url{https://web.natur.cuni.cz/~bayertom/Adk/adk5.pdf}
\textgreater

\bibitem{TB2}
BAYER, Tomáš. \textit{Voronoi diagram} [online].
URL: \textless\url{https://web.natur.cuni.cz/~bayertom/Adk/adk5.pdf}
\textgreater


\end{thebibliography}





\end{document}
